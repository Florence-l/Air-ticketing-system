<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>我的</title>
    <link rel="stylesheet" th:href="@{layui/css/layui.css}">
    <script type="text/javascript" src="/js/jquery-1.8.3.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/css/jqstyle.css"/>
    <link href="//webresource.c-ctrip.com/resaresonline/basebiz/myctrip_online/css/main.72e726c4.css" rel="stylesheet">
    <script type="text/javascript" async="" src="https://webresource.c-ctrip.com/ResUnionOnline/R1/remarketing/js/__nts.js?v=2021416171217"></script>
    <script type="text/javascript" async="" src="https://webresource.c-ctrip.com/ResUnionOnline/R1/remarketing/js/remarketing.js"></script>
    <script async="" src="//www.google-analytics.com/analytics.js"></script>
    <script type="text/javascript" id="rmsd__script" async="" src="https://webresource.tripcdn.com/resaresenglish/risk/ubtrms/d.min.d7a9ee87.js" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8" async="" defer="defer" crossorigin="anonymous" src="//webresource.english.c-ctrip.com/resaresenglish/risk/ubtrms/latest/default/rms.js?v=20210511"></script>
    <script type="text/javascript" async="" src="https://webresource.c-ctrip.com/ResUnionOnline/R3/float/pcfloat.min.js?v=20160329"></script>
    <script type="text/javascript" charset="utf-8" async="" src="https://webresource.english.c-ctrip.com/code/ubt/_bfa.min.js?v=20214_11.js"></script>
    <script>var modernBrowser = (
            'Promise' in window &&
            'assign' in Object &&
            typeof Array.prototype.find === 'function'
        );

        if (!modernBrowser) {
            var src = [
                        "//webresource.c-ctrip.com/resaresonline/basebiz/myctrip_online/polyfills.2698f9fd.js",
            ];
            document.write('<script type="text/javascript" charset="utf-8" src="' + src + '"><\/script>');
        }</script>
    <script>window.__IS_LIMITED__ = false;</script>
    <script type="text/javascript" async="" src="https://accounts.ctrip.com/ssoproxy/ssoGetUserInfo?jsonp=BuildHTML&amp;r=0.6141361128841054&amp;encoding=0"></script>
    <script type="text/javascript" src="https://webresource.c-ctrip.com/ResUnionOnline/R3/float/qCode.min.js"></script>
    <script type="text/javascript" src="https://webresource.c-ctrip.com/ResUnionOnline/R3/float/yUtil.min.js"></script>
    <script type="text/javascript" src="https://webresource.c-ctrip.com/ResUnionOnline/R3/float/floating_normal.min.js?20210511"></script>
    <link type="text/css" rel="stylesheet" href="//webresource.c-ctrip.com/ResUnionOnline/R3/float/css/pc_flaot.css">
    <style type="text/css">
        .message .message_id{
        position: absolute;
        right: 60px;
        top: 32px;
        /* font-size: 18px; */
        display: inline-block;
        max-width: 190px;
        line-height: 24px;
        vertical-align: middle;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 18px;
        cursor: pointer;
        color: #fff;
        text-shadow: 2px 2px 2px rgb(17 119 191 / 50%);
        }




    </style>
</head>
<body>
<th:block th:include="common.html :: header"></th:block>
<th:block th:include="mineside.html :: side"></th:block>
<div style="position: relative;margin-left: 200px;width: auto">
    <div style="padding: 15px;">
        <div class="member-box">
                            <div style="background-image: radial-gradient(#99CCCC, #7171B7); height: 110px">
                                <div class="member-info">
                                    <div class="member-pic">
                                        <span class="member-pic-bg"> </span>
                                        <img width="68" height="68" src="https://dimg04.c-ctrip.com/images/Z80o180000013ulo9C34A.jpg" alt="">
                                        <div class="member-edit" style="display: none;">
                                            <a href="http://you.ctrip.com/members/" rel="noopener referrer" target="_blank">
                                                <i class="i-edit"></i>
                                                <br>编辑资料
                                            </a>
                                        </div>
                                    </div>
                                    <div class="member-name">
                                        <a href="userinfo" rel="noopener referrer" class="member-id">尊敬的会员</a>
                                    </div>

                                </div>
                            </div>
                        </div>
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
            <legend>订单信息</legend>
        </fieldset>
        <div class="layui-tab layui-tab-brief" lay-filter="tab-all">
            <ul class="layui-tab-title">
                <li data-status="" class="layui-this">全部订单</li>
                <li data-status="1">待付款</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                    <table class="layui-hide" id="orderList" lay-filter="test1"></table>
                    <ul class="order-list home-order-list">
                        <li class="load-more ">
                            <a href="/orderdetail">
                                更多订单 >
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="layui-tab-item">
                    <table class="layui-hide" id="orderPay"></table>
                    <ul class="order-list home-order-list">
                        <li class="load-more ">
                            <a href="/orderunpay">
                                更多订单 >
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
</div>

<!--<th:block th:include="common.html :: footer"></th:block>-->


<script th:src="@{layui/layui.js}"></script>
<script th:inline="none">
layui.use(['table'], function(){
  var table = layui.table;//使用数据表格

  table.render({
    elem: '#orderList'
    ,url: 'order' //数据接口
    ,even: true
    ,skin: 'line'
    ,limit: 3
    ,where: {
        status: status
        }
    ,cols: [[ //表头
      {field: 'order_num', title: '订单号', width:150,  fixed: 'left'}
      ,{field: 'user_name', title: '乘客姓名', width:100}
      ,{field: 'seat_id', title: '座位号', width: 90}
      ,{templet:'<div>{{d.flight.departurecity}}</div>', title: '出发城市', width: 100}
      ,{templet:'<div>{{d.flight.arrivalcity}}</div>', title: '到达城市', width: 100}
      ,{templet:'<div>{{d.flight.date}}</div>', title: '日期', width: 130}
      ,{templet:'<div>{{d.flight.departuretime}}</div>', title: '出发时间', width: 130}
      ,{field: 'realPrice', title: '全部金额', width: 135}
      ,{field:'is_valid', width:8+'%', title: '订单状态',

templet:function(d){
if(d.is_valid ==1)
return '已失效'
else if(d.paymentStatus == 1)
return '已支付'
else
return '未支付';
}
}
        ,{field:'', title: '操作', toolbar: "#bar"}

    ]]
  });
  table.render({
    elem: '#orderPay'
    ,url: 'unpay' //数据接口
    ,even: true
    ,skin: 'line'
    ,limit: 3
    ,where: {
        status: status
        }
    ,cols: [[ //表头
      {field: 'order_num', title: '订单号', width:150,  fixed: 'left'}
      ,{field: 'user_name', title: '乘客姓名', width:100}
      ,{field: 'seat_id', title: '座位号', width: 90}
      ,{templet:'<div>{{d.flight.departurecity}}</div>', title: '出发城市', width: 100}
      ,{templet:'<div>{{d.flight.arrivalcity}}</div>', title: '到达城市', width: 100}
      ,{templet:'<div>{{d.flight.date}}</div>', title: '日期', width: 130}
      ,{templet:'<div>{{d.flight.departuretime}}</div>', title: '出发时间', width: 130}
      ,{field: 'realPrice', title: '全部金额', width: 100}
      ,{field:'', title: '操作', toolbar: "#bar"}
    ]]
  });
});

</script>

<script th:inline="none">
    layui.use(['table'], function(){
    })


</script>
<script type="text/html" id="bar">
    <button class="layui-btn layui-btn-normal layui-btn-sm" lay-event="detail" >查看</button>
</script>
<script>
    layui.use(['element', 'table'], function () {
    var $ = layui.jquery, table = layui.table, element = layui.element;
            // 初始化加载
    getList('#orderList', '')
    element.on('tab(tab-all)', function (data) {
                // console.log(this);        // 当前Tab标题所在的原始DOM元素
                // console.log(data.index);  // 得到当前Tab的所在下标
                // console.log(data.elem);   // 得到当前的Tab大容器
                var status = $(this).attr('data-status')
                var position = '#orderList'
                switch (status) {
                    case '1': position = '#orderPay'; break;
                    default: position = '#orderList';
                }
            })
   });
</script>
<script>
//JS
layui.use(['element', 'layer', 'util'], function(){
  var element = layui.element
  ,layer = layui.layer
  ,util = layui.util
  ,$ = layui.$;

  //头部事件
  util.event('lay-header-event', {
    //左侧菜单事件
    menuLeft: function(othis){
      layer.msg('展开左侧菜单的操作', {icon: 0});
    }
    ,menuRight: function(){
      layer.open({
        type: 1
        ,content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
        ,area: ['260px', '100%']
        ,offset: 'rt' //右上角
        ,anim: 5
        ,shadeClose: true
      });
    }
  });

});
</script>

</body>
</html>